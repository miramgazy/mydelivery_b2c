# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å healthcheck –≤ Coolify

## –ü—Ä–æ–±–ª–µ–º–∞
Backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç healthcheck –∏ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ unhealthy, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

## –ü—Ä–∏—á–∏–Ω—ã
1. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**: –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ collectstatic –Ω–∞ –º–∞–ª–æ–º–æ—â–Ω–æ–º VPS –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å –±–æ–ª—å—à–µ 60 —Å–µ–∫—É–Ω–¥
2. **–°—Ç—Ä–æ–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: `set -e` –≤ entrypoint –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–∞–¥–µ–Ω–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏ –ª—é–±—ã—Ö –æ—à–∏–±–∫–∞—Ö
3. **Healthcheck —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–π**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ

## –†–µ—à–µ–Ω–∏—è

### 1. –£–≤–µ–ª–∏—á–µ–Ω start_period –¥–ª—è healthcheck
```yaml
healthcheck:
  start_period: 180s  # –ë—ã–ª–æ 60s
  interval: 15s       # –ë—ã–ª–æ 10s
  timeout: 10s        # –ë—ã–ª–æ 5s
  retries: 10         # –ë—ã–ª–æ 5
```

### 2. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ entrypoint
- –£–±—Ä–∞–Ω `set -e` –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π –Ω–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ø–∞–¥–µ–Ω–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- collectstatic —É–∂–µ –∏–º–µ–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π —Ç–µ–ø–µ—Ä—å –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### docker-compose.coolify.yml
- `start_period`: 60s ‚Üí 180s (3 –º–∏–Ω—É—Ç—ã –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é)
- `interval`: 10s ‚Üí 15s (—Ä–µ–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
- `timeout`: 5s ‚Üí 10s (–±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ—Ç–≤–µ—Ç)
- `retries`: 5 ‚Üí 10 (–±–æ–ª—å—à–µ –ø–æ–ø—ã—Ç–æ–∫)

### backend/docker-entrypoint-coolify.sh
- –£–±—Ä–∞–Ω `set -e` –≤ –Ω–∞—á–∞–ª–µ (–≥–∏–±–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø–∞–¥–∞—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π –ø–æ–¥–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏
- `set -e` –≤–∫–ª—é—á–µ–Ω —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ `exec "$@"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ backend
docker logs <backend-container-name>

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ healthcheck
docker inspect <backend-container-name> | grep -A 10 Health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç
curl http://localhost:8000/api/
```

## –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π
2. **–£–≤–µ–ª–∏—á—å—Ç–µ start_period** –¥–æ 240s (4 –º–∏–Ω—É—Ç—ã)
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î** - –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ DATABASE_URL
4. **–í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ healthcheck** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
   ```yaml
   # –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ healthcheck –≤ docker-compose.coolify.yml
   ```
