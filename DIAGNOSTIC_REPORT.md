# üîç –û—Ç—á–µ—Ç –æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Å–∫–∞—á–∫–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏ CPU

**–î–∞—Ç–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:** 27 —è–Ω–≤–∞—Ä—è 2026  
**–ü—Ä–æ–µ–∫—Ç:** tg-delivery B2C

## üìä –†–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ä–µ–∑–∫–∏–µ —Å–∫–∞—á–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU —Å–µ—Ä–≤–µ—Ä–∞. –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ **3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö** –∏ **5 –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö** –ø—Ä–æ–±–ª–µ–º.

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. ‚ö†Ô∏è –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ API

**–§–∞–π–ª:** `frontend/src/services/api.js:27`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// –ê–Ω—Ç–∏-–∫—ç—à –∏ —É–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
config.params = config.params || {};
config.params._t = Date.now();
```

–ö–∞–∂–¥—ã–π HTTP-–∑–∞–ø—Ä–æ—Å –¥–æ–±–∞–≤–ª—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `_t`, —á—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–≤. –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

**–í–ª–∏—è–Ω–∏–µ:**
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —É–Ω–∏–∫–∞–ª–µ–Ω, –∫—ç—à –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –ü—Ä–∏ 100 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å 100+ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU –∏ —Å–µ—Ç—å

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –£–±—Ä–∞—Ç—å `_t` –¥–ª—è GET-–∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å
- –û—Å—Ç–∞–≤–∏—Ç—å `_t` —Ç–æ–ª—å–∫–æ –¥–ª—è POST/PUT/DELETE –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —É–º–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

---

### 2. ‚ö†Ô∏è –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π polling —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ PhoneInputView

**–§–∞–π–ª:** `frontend/src/views/onboarding/PhoneInputView.vue:153-193`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// Polling –∫–∞–∂–¥—ã–µ 500ms-1000ms
phonePollInterval = setInterval(async () => {
  const current = await fetchPhoneFromBackendOnce() // –í—ã–∑—ã–≤–∞–µ—Ç fetchCurrentUser()
}, intervalMs)

// –§–æ–Ω–æ–≤—ã–π polling –¥–æ 30 —Å–µ–∫—É–Ω–¥
backgroundPollInterval = setInterval(async () => {
  const current = await fetchPhoneFromBackendOnce()
}, 1000) // –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É!
```

**–í–ª–∏—è–Ω–∏–µ:**
- –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- `fetchPhoneFromBackendOnce()` –≤—ã–∑—ã–≤–∞–µ—Ç `authStore.fetchCurrentUser()` ‚Üí `/api/users/me/`
- –ü—Ä–∏ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ = 10 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥ = 300 –∑–∞–ø—Ä–æ—Å–æ–≤
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É, polling –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ 3-5 —Å–µ–∫—É–Ω–¥
- –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff (—É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º)
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è polling –¥–æ 15 —Å–µ–∫—É–Ω–¥
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É: –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ (tab hidden), –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å polling

---

### 3. ‚ö†Ô∏è –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã fetchCurrentUser –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `frontend/src/App.vue:36-37, 88-89`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// –í App.vue onMounted:
if (authService.isAuthenticated() && !authStore.isAuthenticated) {
  await authStore.fetchCurrentUser() // –ó–∞–ø—Ä–æ—Å 1
}

if (!authStore.isAuthenticated) {
  loginResult = await authStore.login() // –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å fetchCurrentUser –≤–Ω—É—Ç—Ä–∏
}

// –í desktop —Ä–µ–∂–∏–º–µ:
if (!authStore.isAuthenticated) {
  await authStore.fetchCurrentUser() // –ó–∞–ø—Ä–æ—Å 2
}
```

**–í–ª–∏—è–Ω–∏–µ:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å 2-3 –∑–∞–ø—Ä–æ—Å–∞ `/api/users/me/` –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–ª–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —ç—Ç–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è
- –£—Å–∏–ª–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å debounce/throttle –¥–ª—è `fetchCurrentUser`
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 5-10 —Å–µ–∫—É–Ω–¥
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥ `isFetching` —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## ‚ö° –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –≤ OrderDetailView

**–§–∞–π–ª:** `frontend/src/views/OrderDetailView.vue:198-200`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
timer.value = setInterval(() => {
  now.value = Date.now() // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
}, 1000)
```

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã, –Ω–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU –∫–ª–∏–µ–Ω—Ç–∞
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π
- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤ `onBeforeUnmount`, –Ω–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏, —Ç–∞–π–º–µ—Ä—ã –º–æ–≥—É—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `requestAnimationFrame` –≤–º–µ—Å—Ç–æ `setInterval` –¥–ª—è –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Page Visibility API)

---

### 5. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∫–∞–∂–¥–æ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–§–∞–π–ª—ã:**
- `frontend/src/views/HomeView.vue:138` - `fetchMyOrders()`
- `frontend/src/views/OrdersView.vue:105` - `fetchMyOrders()`
- `frontend/src/views/MenuView.vue:180` - `productsStore.refresh()`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ–ª–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏
- –ü—Ä–∏ —á–∞—Å—Ç–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏–∑–±—ã—Ç–æ—á–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ stores (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ < 30 —Å–µ–∫—É–Ω–¥)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `keep-alive` –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ —Ä–æ—É—Ç–µ—Ä–µ
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ `staleTime` –≤ stores

---

### 6. Watch –Ω–∞ searchQuery –±–µ–∑ debounce

**–§–∞–π–ª:** `frontend/src/views/MenuView.vue:128-130`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
watch(searchQuery, (value) => {
  productsStore.setSearchQuery(value)
})
```

**–í–ª–∏—è–Ω–∏–µ:**
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º —Å–∏–º–≤–æ–ª–µ –≤ –ø–æ–∏—Å–∫–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è computed `availableProducts`
- –•–æ—Ç—è —ç—Ç–æ –Ω–µ –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã, –Ω–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±–æ–ª—å—à–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
- –ü—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –≤–≤–æ–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å debounce (300-500ms) –¥–ª—è watch
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `watchDebounced` –∏–∑ VueUse

---

### 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö –∫–ª–∏–∫–æ–≤
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å axios interceptor –¥–ª—è rate limiting
- –î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `axios-rate-limit` –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

---

### 8. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ backend

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ Celery tasks - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ `send_order_to_iiko_task`, –Ω–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è
- ‚úÖ Celery Beat - –Ω–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ù–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ –≤ –∫–æ–¥–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (N+1 queries)
- –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):

1. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å api.js:**
   - –£–±—Ä–∞—Ç—å `_t` –¥–ª—è GET-–∑–∞–ø—Ä–æ—Å–æ–≤
   - –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é `skipCacheBust: true` –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å

2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å PhoneInputView:**
   - –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª polling –¥–æ 3-5 —Å–µ–∫—É–Ω–¥
   - –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–æ 15 —Å–µ–∫—É–Ω–¥
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å App.vue:**
   - –î–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ `isFetching` –≤ authStore
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç `fetchCurrentUser` –Ω–∞ 10 —Å–µ–∫—É–Ω–¥
   - –ò–∑–±–µ–≥–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):

4. **–î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ stores:**
   - –î–æ–±–∞–≤–∏—Ç—å `lastFetch` timestamp
   - –ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ (< 30 —Å–µ–∫—É–Ω–¥)

5. **–î–æ–±–∞–≤–∏—Ç—å rate limiting:**
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
   - –î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):

6. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–π–º–µ—Ä—ã:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Page Visibility API
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI

7. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É

---

## üîß –ë–´–°–¢–†–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è api.js

```javascript
// frontend/src/services/api.js
api.interceptors.request.use(
    (config) => {
        console.log('AXIOS REQUEST: Sending to ' + config.url)
        const token = localStorage.getItem('access_token')

        if (token && !config.skipAuth) {
            config.headers.Authorization = `Bearer ${token}`
        }

        // –ê–Ω—Ç–∏-–∫—ç—à —Ç–æ–ª—å–∫–æ –¥–ª—è POST/PUT/DELETE –∏–ª–∏ –µ—Å–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ
        if (!config.skipCacheBust && ['post', 'put', 'patch', 'delete'].includes(config.method?.toLowerCase())) {
            config.params = config.params || {};
            config.params._t = Date.now();
        }
        // –î–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º _t, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à

        return config
    },
    (error) => {
        return Promise.reject(error)
    }
)
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è PhoneInputView

```javascript
// frontend/src/views/onboarding/PhoneInputView.vue

// –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
async function waitForPhoneFromBackend({ maxWaitMs = 5000, intervalMs = 2000 } = {}) {
  // intervalMs: 500 -> 2000 (2 —Å–µ–∫—É–Ω–¥—ã)
}

function startBackgroundPhonePolling({ maxWaitMs = 15000, intervalMs = 3000 } = {}) {
  // maxWaitMs: 30000 -> 15000 (15 —Å–µ–∫—É–Ω–¥)
  // intervalMs: 1000 -> 3000 (3 —Å–µ–∫—É–Ω–¥—ã)
  
  // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  if (document.hidden) {
    cleanupPhonePolling()
    return
  }
  
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ authStore

```javascript
// frontend/src/stores/auth.js

const lastFetchTime = ref(0)
const CACHE_DURATION = 10000 // 10 —Å–µ–∫—É–Ω–¥

async function fetchCurrentUser() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
    if (Date.now() - lastFetchTime.value < CACHE_DURATION && user.value) {
        return user.value
    }
    
    if (!authService.isAuthenticated()) {
        return null
    }

    loading.value = true
    error.value = null

    try {
        const userData = await authService.getCurrentUser()
        user.value = userData
        lastFetchTime.value = Date.now()
        return userData
    } catch (err) {
        // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
    } finally {
        loading.value = false
    }
}
```

---

## üìä –ú–ï–¢–†–ò–ö–ò –î–õ–Ø –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:

1. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É** (–¥–æ–ª–∂–Ω–æ —Å–Ω–∏–∑–∏—Ç—å—Å—è –Ω–∞ 50-70%)
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU** (–¥–æ–ª–∂–Ω–æ —Å–Ω–∏–∑–∏—Ç—å—Å—è –Ω–∞ 30-50%)
3. **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API** (–¥–æ–ª–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å—Å—è –∑–∞ —Å—á–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è)
4. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞ (—Å—Ç–∞—Ç—É—Å 304)
5. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ CPU –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å–æ–≤

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å:
1. **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
2. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º polling** —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É)
3. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏** –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–∂–∏–¥–∞–µ—Ç—Å—è —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU –Ω–∞ **30-50%** –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ **50-70%**.

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –Ω–∞ —Ç–æ–º –∂–µ VPS —Å–µ—Ä–≤–µ—Ä–µ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –Ω–∞–≥—Ä—É–∑–∫–∏.
